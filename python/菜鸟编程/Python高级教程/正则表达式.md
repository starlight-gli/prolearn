# Python 正则表达式

[有一定理解]

正则表达式是一个特殊的字符序列，方便你检查一个字符串是否与某种模式匹配。

主要使用`re`模块。

`re` 模块提供了一组函数，允许你在字符串中进行**模式匹配**、**搜索**和**替换操作**。

## 一、`re.match`函数

`re.match` 尝试从字符串的起始位置匹配一个模式，若非起始位置匹配成功的话，match() 就返回 None。

```python
re.match(pattern, string, flags=0)
#pattern	匹配的正则表达式
#string	要匹配的字符串。
#flags	标志位，用于控制正则表达式的匹配方式，如：是否区分大小写，多行匹配等等。参见：正则表达式修饰符 - 可选标志
```

## 二、`re.search`方法

`re.search`扫描整个字符串并返回第一个成功的匹配

```pyhton
re.search(pattern, string, flags=0)
```

## 三、检索和替换

Python的re模块提供了`re.sub`用于替换字符串中的匹配项。

语法：

```python
re.sub(pattern, repl, string, count=0, flags=0)
```

- `pattern`: 正则中的模式字符串。
- `repl` : 替换的字符串，也可为一个函数。
- `string` : 要被查找替换的原始字符串。
- `count` : 模式匹配后替换的最大次数，默认 0 表示替换所有的匹配。
- `flags` : 编译时用的匹配模式，数字形式。

```python
import re
 
phone = "2004-959-559 # 这是一个电话号码"
 
# 删除注释
num = re.sub(r'#.*$', "", phone)
print ("电话号码 : ", num)
 
# 移除非数字的内容
num = re.sub(r'\D', "", phone)
print ("电话号码 : ", num)
```

#### 1. 导入模块与初始字符串

```python
import re

phone = "2004-959-559 # 这是一个电话号码"
```

- 导入 `re` 模块，用于正则操作
- 定义初始字符串 `phone`，包含电话号码、分隔符 `-` 和注释 `# 这是一个电话号码`

#### 2. 第一步：删除注释

```python
# 删除注释
num = re.sub(r'#.*$', "", phone)
print("电话号码 : ", num)  # 输出：电话号码 :  2004-959-559 
```

- **正则模式 `r'#.\*$'` 解析**：
  - `#`：匹配字符 `#`（注释的起始标记）
  - `.*`：`.*` 是通配符，`.'` 匹配任意字符（除换行符），`*` 表示匹配前面的字符 0 次或多次，合起来表示 “`#` 后面的所有字符”
  - `$`：匹配字符串的结尾，确保从 `#` 一直匹配到字符串结束
  - `r` 前缀：表示原始字符串（raw string），避免 Python 对反斜杠的转义处理（这里虽无反斜杠，但正则中通常建议加 `r`）
- **替换逻辑**：
  - 用空字符串 `""` 替换所有匹配 `#.*$` 的部分（即从 `#` 开始到字符串结尾的注释内容）
  - 原始字符串中 `# 这是一个电话号码` 被替换为空，剩下 `2004-959-559 `（末尾有空格，因为原字符串中 `#` 前有空格）

#### 3. 第二步：移除非数字内容

```python
# 移除非数字的内容
num = re.sub(r'\D', "", phone)
print("电话号码 : ", num)  # 输出：电话号码 :  2004959559
```

- **正则模式 `r'\D'` 解析**：
  - `\D` 是正则中的特殊序列，表示 “匹配所有非数字字符”（等价于 `[^0-9]`）
  - 非数字字符包括： `-`、`#`、空格、汉字等
- **替换逻辑**：s
  - 用空字符串 `""` 替换所有非数字字符
  - 原始字符串中的 `-`、`#`、空格、汉字全部被移除，只剩下数字 `2004959559`
## 第二章  内置模块

* **学习指导**：本章内容较多，一口气难易熟练掌握。打造字典式笔记，方便以后回顾。

### 第一节  time模块

* **内容简介**

* **要点展示**

[`time.time` , `time.sleep` , `time.localtime` , `time.strftime` , `time.strptime` ,

`time.gmtime` , `time.mktime` , `time.asctime` , `time.ctime` ]

* **名词拓展**



---

####  常用函数介绍

1. `time.time` 
2. `time.sleep` 
3. `time.localtime` 
4. `time.strftime` 
5. `time.strptime` 
6. `time.gmtime` 
7. `time.mktime` 
8. `time.asctime` 
9. `time.ctime` 

---

### 第二节 datetime模块

* **内容简介**

* **要点展示**
  
  * 常用类
  
  [`datetime.date` , `datetime.time` , `datetime.datetime` , `datetime.timedelta` ]
  
  * 常用方法
  
  [获取当前时间 , 字符串与日期的转换 , 时间加减运算 , 时区处理 , 常用格式符号 , 比较日期和时间]

* **名词拓展** 

  [类，类的实例化]

---

#### 常用类

1. `datetime.date` 处理日期（年、月、日）

   `date` 类仅关注**年、月、日**，不包含时间信息，适用于表示纯粹的日期（如生日、节假日）。

   * 核心属性

     * `year`：年份（整数，如 2023）
     * `month`：月份（整数，1-12）
     * `day`：日期（整数，1-31，取决于月份）

   * 核心方法

     * `today()`：返回当前本地日期（`date` 对象）。
     * `strftime(format)`：将日期格式化为指定字符串（如 `"%Y年%m月%d日"` 转换为 "2023 年 10 月 01 日"）。
     * `weekday()`：返回星期几（0 = 周一，6 = 周日）。

   * 代码展示

     ```python
     from datetime import date
     
     # 获取当前日期
     today = date.today()
     print(today)  # 输出：2023-10-01（假设当前日期）
     print(today.year, today.month, today.day)  # 输出：2023 10 1
     
     # 格式化日期
     print(today.strftime("%Y年%m月%d日 星期%w"))  # 输出：2023年10月01日 星期0（周日）
     ```

     

2. `datetime.time` 处理时间（时、分、秒、微秒）

   `time` 类仅关注**时、分、秒、微秒**，不包含日期信息，适用于表示一天中的某个时间点（如闹钟时间、会议时间）。

   * 核心属性

     * `hour`：小时（0-23）
     * `minute`：分钟（0-59）
     * `second`：秒（0-59）
     * `microsecond`：微秒（0-999999）

   * 核心方法

     * `strftime(format)`：将时间格式化为指定字符串（如 `"%H:%M:%S"` 转换为 "14:30:00"）。

   * 代码展示

     ```python
     from datetime import time
     
     # 创建时间对象（时:分:秒:微秒）
     meeting_time = time(14, 30, 0)  # 14:30:00
     print(meeting_time.hour, meeting_time.minute)  # 输出：14 30
     
     # 格式化时间
     print(meeting_time.strftime("%I:%M %p"))  # 输出：02:30 PM（12小时制，带上午/下午）
     ```

     

3. `datetime.datetime` 处理日期 + 时间（最常用）

   `datetime` 类是 `date` 和 `time` 的结合，同时包含**年、月、日、时、分、秒、微秒**，是处理完整时间信息的最常用类（如日志时间、事件时间）。

   * 核心属性

     * 继承 `date` 和 `time` 的所有属性（`year`、`month`、`day`、`hour` 等）。

   * 核心方法

     * `now()`：返回当前本地日期和时间（`datetime` 对象）。
     * `strptime(date_string, format)`：从指定格式的字符串解析为 `datetime` 对象（如 `"2023-10-01 14:30:00"`）。
     * `date()` / `time()`：分别提取 `datetime` 中的 `date` 或 `time` 部分。

   * 代码展示

     ```python
     from datetime import datetime
     
     # 获取当前完整时间
     now = datetime.now()
     print(now)  # 输出：2023-10-01 14:30:00.123456（包含微秒）
     
     # 解析字符串为datetime对象
     log_time = datetime.strptime("2023-10-01 14:30:00", "%Y-%m-%d %H:%M:%S")
     print(log_time.date())  # 提取日期：2023-10-01
     print(log_time.time())  # 提取时间：14:30:00
     ```

     

4.  `datetime.timedelta` 处理时间间隔

   `timedelta` 类表示**两个时间点之间的差值**（如 2 天、3 小时），可用于时间的加减运算（如计算未来 / 过去的时间）。

   ```python
   # timedelta 类
   class datetime.timedelta(
      days=0, seconds=0, microseconds=0,
      milliseconds=0, minutes=0, hours=0, weeks=0
   )
   ```

   * 核心属性

     * `days`：天数（整数或浮点数，如 2、0.5 代表 12 小时）
     * `seconds`：秒数（1 小时 = 3600 秒）
     * `microseconds`：微秒数（1 秒 = 1000000 微秒）
     * 注意：没有 `months` 或 `years` 参数（因月份天数不固定，需手动处理）。

   * 代码展示

     ```python
     from datetime import datetime, timedelta
     
     # 当前时间
     now = datetime.now()
     
     # 计算3天后的时间
     future = now + timedelta(days=3)
     print(future)  # 输出：3天后的同一时间
     
     # 计算1小时30分钟前的时间
     past = now - timedelta(hours=1, minutes=30)
     print(past)  # 输出：1小时30分钟前的时间
     
     # 两个时间的差值（返回timedelta对象）
     delta = future - past
     print(delta.days, delta.seconds)  # 输出：3天 + （剩余秒数）
     ```

     

5. 四个类的表格总结

   | 类名        | 包含信息             | 适用场景                              |
   | ----------- | -------------------- | ------------------------------------- |
   | `date`      | 年、月、日           | 仅需日期（如生日、订单日期）          |
   | `time`      | 时、分、秒、微秒     | 仅需时间（如闹钟、每日固定时刻）      |
   | `datetime`  | 日期 + 时间          | 完整时间信息（如日志、事件时间）      |
   | `timedelta` | 时间间隔（天、秒等） | 时间加减运算（如计算未来 / 过去时间） |



---

### 第三节 os模块

* **内容简介**

  在 Python 中，`os` 模块提供了与**操作系统**进行**交互**的功能，允许你**执行文件**和**目录操作**、**环境变量管理**、**进程管理**等

* **要点展示**

  [文件目录操作，环境变量管理，进程系统操作，跨平台兼容，

  高级用法]

* **名词拓展**



---

#### 文件与目录操作

* 路径操作

  ```python
  import os
  
  # 获取当前工作目录
  current_dir = os.getcwd()  # 输出：'/path/to/current/directory'
  
  # 拼接路径（自动适配不同操作系统的路径分隔符）
  path = os.path.join('dir1', 'dir2', 'file.txt')  # 输出：'dir1/dir2/file.txt'（Linux/macOS）或 'dir1\\dir2\\file.txt'（Windows）
  
  # 拆分路径为目录和文件名
  dirname, filename = os.path.split('/path/to/file.txt')  # 输出：('/path/to', 'file.txt')
  
  # 获取文件扩展名
  ext = os.path.splitext('file.txt')[1]  # 输出：'.txt'
  ```

  

* 目录操作

  ```python
  # 创建目录（单级）
  os.mkdir('new_dir')  # 若目录已存在会报错
  
  # 创建多级目录
  os.makedirs('dir1/dir2/dir3')  # 自动创建中间目录
  
  # 删除目录（必须为空）
  os.rmdir('empty_dir')
  
  # 列出目录内容
  files = os.listdir('.')  # 返回当前目录下的所有文件和文件夹
  ```

  

* 文件操作

  ```python
  # 重命名文件/目录
  os.rename('old_name.txt', 'new_name.txt')
  
  # 删除文件
  os.remove('temp.txt')
  
  # 判断路径是否存在
  exists = os.path.exists('/path/to/file')  # 返回 True 或 False
  
  # 判断是文件还是目录
  is_file = os.path.isfile('/path/to/file')
  is_dir = os.path.isdir('/path/to/dir')
  
  # 获取文件大小（字节）
  size = os.path.getsize('data.csv')
  ```

  


#### 环境与变量管理

```python
# 获取环境变量
home_dir = os.environ.get('HOME')  # Linux/macOS 下为用户主目录，Windows 下为 'USERPROFILE'
path_env = os.environ.get('PATH')  # 系统路径变量

# 设置临时环境变量（仅对当前进程有效）
os.environ['MY_VAR'] = 'my_value'
```



#### 进程与系统操作

* 执行系统命令

  ```python
  # 执行 shell 命令（返回状态码）
  status = os.system('ls -l')  # Linux/macOS
  status = os.system('dir')    # Windows
  
  # 更推荐使用 subprocess 模块执行复杂命令
  ```

  

* 获取进程信息

  ```python
  # 获取当前进程 ID
  pid = os.getpid()
  
  # 获取父进程 ID
  ppid = os.getppid()
  ```

  

* 系统相关

  ```python
  # 使用 os.path.join() 代替硬编码路径分隔符
  path = os.path.join('data', 'subdir', 'file.txt')
  
  # 判断操作系统类型执行不同逻辑
  if os.name == 'posix':
      # Linux/macOS 系统
      os.system('ls')
  else:
      # Windows 系统
      os.system('dir')
  ```

  

#### 跨平台兼容技巧

```python
# 使用 os.path.join() 代替硬编码路径分隔符
path = os.path.join('data', 'subdir', 'file.txt')

# 判断操作系统类型执行不同逻辑
if os.name == 'posix':
    # Linux/macOS 系统
    os.system('ls')
else:
    # Windows 系统
    os.system('dir')
```



#### 高级用法

* **使用 `os.scandir()` 高效遍历目录（Python 3.5+）** 

  ```python
  with os.scandir('.') as entries:
      for entry in entries:
          if entry.is_file():
              print(f"文件: {entry.name}, 大小: {entry.stat().st_size} 字节")
          elif entry.is_dir():
              print(f"目录: {entry.name}")
  ```

  

* **使用 `os.walk()` 递归遍历目录树** 

* ```python
  for root, dirs, files in os.walk('my_project'):
      print(f"当前目录: {root}")
      print(f"子目录: {dirs}")
      print(f"文件: {files}")
      print("-" * 20)
  ```

  

#### 总结`os 模块核心功能表

| 功能分类 | 常用方法 / 属性                                  | 说明                     |
| -------- | ------------------------------------------------ | ------------------------ |
| 路径处理 | `os.path.join()`, `os.path.split()`              | 跨平台路径拼接与拆分     |
| 目录操作 | `os.mkdir()`, `os.makedirs()`, `os.rmdir()`      | 创建 / 删除目录          |
| 文件操作 | `os.rename()`, `os.remove()`, `os.path.exists()` | 文件管理与检查           |
| 环境变量 | `os.environ`                                     | 获取 / 设置环境变量      |
| 系统命令 | `os.system()`                                    | 执行 shell 命令          |
| 进程信息 | `os.getpid()`, `os.getppid()`                    | 获取进程 ID              |
| 系统类型 | `os.name`, `os.linesep`                          | 判断操作系统类型和换行符 |



---

### 第四节 sys模块

* **内容简介**

  Python 的`sys`模块提供了与 Python 解释器和系统环境交互的功能。


* **要点展示**

  [命令行参数 , 解释器信息 , 标准输入、输出、错误 , 退出程序 , 内存和递归限制 , 异常处理 , 环境变量 , 常用属性总结 ]

* **名词拓展**

---

#### 命令行参数

`sys.argv` 是一个包含命令行参数的列表，其中：

- `sys.argv[0]`：脚本名称（可能是相对路径或绝对路径）

- `sys.argv[1:]`：传递给脚本的参数

  ```
  # test.py
  import sys
  
  print(f"脚本名称：{sys.argv[0]}")
  print(f"参数数量：{len(sys.argv) - 1}")
  print(f"所有参数：{sys.argv[1:]}")
  ```

  

#### 解释器信息

* 核心属性

  * `ys.version`：Python 版本字符串（如 `3.10.0 (default, ...)`）
  * `sys.version_info`：版本信息元组（如 `sys.version_info(major=3, minor=10, micro=0, ...)`）
  * `sys.executable`：Python 解释器的路径
  * `sys.platform`：运行平台（如 `'linux'`, `'win32'`, `'darwin'`）

* 代码展示

  ```python
  import sys
  
  print(f"Python 版本：{sys.version}")
  print(f"平台：{sys.platform}")
  print(f"解释器路径：{sys.executable}")
  
  # 判断 Python 版本是否 >= 3.8
  if sys.version_info >= (3, 8):
      print("Python 版本符合要求")
  ```

  

#### 标准输入、输出、错误

* 常用函数

  * `sys.stdout`：标准输出（默认打印到控制台）
  * `sys.stderr`：标准错误（默认打印到控制台，用于错误信息）
  * `sys.stdin`：标准输入（默认从键盘读取）

* 代码展示

​	**重定向标准输出到文件**

  ```python
  import sys
  
  # 保存原始输出流
  original_stdout = sys.stdout
  
  # 重定向到文件
  with open('output.txt', 'w') as f:
      sys.stdout = f
      print("这条信息会被写入文件")
  
  # 恢复原始输出流
  sys.stdout = original_stdout
  print("这条信息会显示在控制台")
  ```

  **从标准输入读取**

```python
import sys

print("请输入内容，按 Ctrl+D (Linux/macOS) 或 Ctrl+Z (Windows) 结束：")
data = sys.stdin.read()
print(f"你输入的内容是：\n{data}")
```

#### 退出程序 `sys.exit([arg])`

* 函数展示

  * `sys.exit()`：终止当前程序，返回状态码 0（表示成功）
  * `sys.exit(n)`：返回状态码 `n`（非零表示错误，通常被 shell 捕获）
  * `sys.exit("错误信息")`：打印错误信息并返回状态码 1

* 代码展示

  ```python
  import sys
  
  def main():
      if len(sys.argv) < 2:
          sys.exit("错误：请提供至少一个参数")
      
      # 正常逻辑...
      print(f"处理参数：{sys.argv[1]}")
      return 0
  
  if __name__ == "__main__":
      sys.exit(main())
  ```

  

#### 内存和递归限制

* 递归深度限制：

  * `sys.getrecursionlimit()`：获取最大递归深度（默认约 1000）
  
  * `sys.setrecursionlimit(limit)`：设置最大递归深度
  
  * 代码展示
  
    ```python
    import sys
    
    # 获取当前递归限制
    print(f"默认递归深度限制：{sys.getrecursionlimit()}")
    
    # 设置新的递归限制
    sys.setrecursionlimit(5000)
    print(f"新的递归深度限制：{sys.getrecursionlimit()}")
    ```
  
    
  
* 对象大小：

  * `sys.getsizeof(obj)`：返回对象占用的内存大小（字节）

    ```python
    import sys
    
    a = [1, 2, 3]
    print(f"列表占用内存：{sys.getsizeof(a)} 字节")  # 通常比实际元素占用的内存大（包含元数据）
    ```


#### 异常处理

* 函数展示

    * `sys.exc_info()`：返回当前处理的异常信息三元组`(type, value, traceback)`
        * `type`：异常类型（如 `ValueError`）
        * `value`：异常实例（包含错误信息）
        * `traceback`：跟踪对象（包含调用栈信息）

* 代码示例

    ```python
    import sys
    
    try:
        result = 1 / 0  # 触发 ZeroDivisionError
    except:
        exc_type, exc_value, exc_traceback = sys.exc_info()
        print(f"异常类型：{exc_type}")
        print(f"异常信息：{exc_value}")
        print(f"错误发生在第 {exc_traceback.tb_lineno} 行")
    ```

    

#### 环境变量（`sys.path`）

* 函数

  - `sys.path`：模块搜索路径列表（Python 查找 `import` 模块的路径）

  - 修改 `sys.path` 可临时添加自定义模块路径

* 代码示例

  ```python
  import sys
  
  # 打印模块搜索路径
  print("模块搜索路径：")
  for path in sys.path:
      print(path)
  
  # 临时添加自定义模块路径
  sys.path.append('/path/to/my/modules')
  import my_custom_module  # 现在可以导入该路径下的模块
  ```

  

#### 常用属性总结

| 属性 / 方法                    | 描述                                                       |
| ------------------------------ | ---------------------------------------------------------- |
| `sys.argv`                     | 命令行参数列表，`argv[0]` 是脚本名，后续元素是传递的参数。 |
| `sys.version`                  | Python 版本字符串。                                        |
| `sys.version_info`             | 版本信息元组 `(major, minor, micro, ...)`。                |
| `sys.executable`               | Python 解释器的路径。                                      |
| `sys.platform`                 | 运行平台（如 `'linux'`, `'win32'`, `'darwin'`）。          |
| `sys.stdout`                   | 标准输出流，可重定向（如写入文件）。                       |
| `sys.stderr`                   | 标准错误流，用于输出错误信息。                             |
| `sys.stdin`                    | 标准输入流，用于读取用户输入。                             |
| `sys.exit([arg])`              | 退出程序，返回状态码（默认 0 表示成功，非零表示错误）。    |
| `sys.getrecursionlimit()`      | 获取最大递归深度。                                         |
| `sys.setrecursionlimit(limit)` | 设置最大递归深度。                                         |
| `sys.getsizeof(obj)`           | 返回对象占用的内存大小（字节）。                           |
| `sys.exc_info()`               | 返回当前异常的三元组 `(type, value, traceback)`。          |
| `sys.path`                     | 模块搜索路径列表，可动态修改。                             |

---

### 第五节 日志模块（logging）

* **内容简介**


* **要点展示**

* **名词拓展**

  [`root` , 记录器 , 事件严重性]

---





